---
layout: post
title: 트랜잭션(Transaction) 알아보기
tags: [db, sql]
categories:
  - DB
date: 2023-05-24
---

# 트랜잭션이란?

<br>

트랜잭션은 더이상 분할이 불가능한 업무처리의 단위를 의미함.

한꺼번에 수행되어야 할 일련의 연산모음을 의미함.

데이터베이스에서 테이블의 데이터를 읽어 온 후 다른 테이블에 데이터를 입력하거나 갱신, 삭제하는 도중에 오류가 발생하면, 결과를 재반영하는 것이 아니라 모든 작업을 원상태로 복구하고, 처리 과정이 모두 성공하였을 때만 그 결과를 반영 함.

이런 트랜잭션을 상황에 따라 여러 개가 만들어질 수 있음.

## MySQL 트랜잭션

<br>

MySQL에서 트랜잭션은 데이터베이스의 상태를 바꾸는 일종의 작업 단위임.

데이터베이스의 상태를 변경시키기 위해 수행하는 작업단위로 SELECT, UPDATE, INSERT, DELETE와 같은 행동을 뜻함.

MySQL에 입력하는 모든 쿼리 명령어들은 각각 하나의 트랜잭션이라고 할 수 있음.

INSERT, DELETE, UPDATE 등의 SQL 명령문을 통해 데이터 상태를 바꿀 때마다 내부적으로 자동적으로 Commit을 실행하여 변경된 내역을 데이터베이스에 반영하는 것.

## 트랜잭션의 특징

<br>

- 원자성  
  트랜잭션의 DB에 모두 반영되거나, 전혀 반영되지 않아야 한다는 것임. (All or Nothing)

- 일관성  
  트랜잭션 작업 처리의 결과가 항상 일관되어야 한다를 뜻함.  
  즉, 데이터 타입이 반환 후와 전이 항상 동일해야 함

- 독립성  
  하나의 트랜잭션은 다른 트랜잭션에 끼어들 수 없고 마찬가지로 독립적임을 의미함.  
  즉, 각각의 트랜잭션은 독립적이라 서로 간섭이 불가능함.

- 지속성  
  트랜잭션이 성공적으로 완료되면 영구적으로 결과에 반영되어야 함을 뜻함.  
  commit이 된다면 지속성이 만족 된 것.

## 트랜잭션의 Commit과 Rollback

<br>

✅ Commit

하나의 트랜잭션이 성공적으로 끝나서 데이터베이스가 일관성있는 상태에 있음을 의미. 해당 처리 과정을 DB에 영구 저장하겠다는 의미이며, Commit 을 수행하면 하나의 트랜잭션 과정이 종료 되는 것  
Commit을 수행하면 이전 데이터가 완전히 반영되어 UPDATE됨

✅ Roll-back

Roll-back은 하나의 트랜잭션 처리가 비정상적으로 종료되어 트랜잭션의 원자성이 깨진경우
트랜잭션을 처음부터 다시 시작하거나, 트랜잭션의 부분적으로만 변경된 결과를 취소하는 명령어임.  
이는 마지막 Commit을 완료한 시점으로 돌아간다는 말과 같음.  
즉, Roll-back은 Commit 하여 저장된 예전 상태를 복구하는 것임.

## 트랜잭션의 상태

<br>

트랜잭션은 논리적으로 5가지의 상태에 있을 수 있음.

- Active

  - 트랜잭션이 현재 실행 중인 상태

- Failed

  - 트랜잭션이 실행되다 오류가 발생해서 중단된 상태

- Aborted

  - 트랜잭션이 비정상 종료되어 Rollback이 수행된 상태

- Partially Committed

  - 트랜잭션의 연산이 마지막까지 실행되고 Commit이 되기 직전 상태

- Committed
  - 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태

<br>

### 📌 참고 블로그

<br>

[[데이터베이스] Transaction, 트랜잭션이란?](https://wonit.tistory.com/462)

[[MYSQL] 📚 트랜잭션(Transaction) 개념 & 사용 💯 완벽 정리](https://inpa.tistory.com/entry/MYSQL-%F0%9F%93%9A-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98Transaction-%EC%9D%B4%EB%9E%80-%F0%9F%92%AF-%EC%A0%95%EB%A6%AC)
